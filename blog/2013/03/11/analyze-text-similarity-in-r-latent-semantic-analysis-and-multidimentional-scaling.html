<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <!-- (1) Optimize for mobile versions: http://goo.gl/EOpFl -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- (1) force latest IE rendering engine: bit.ly/1c8EiC9 -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Analyze Text Similarity with R: Latent Semantic Analysis and Multidimentional Scaling</title>
  <meta name="description" content="Background" />

  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@bod0ng" />
    <meta name="twitter:title" content="Analyze Text Similarity with R: Latent Semantic Analysis and Multidimentional Scaling" />
    <meta name="twitter:image" content="http://bodong.ch//assets/images/df_logo.png" />
    
    <meta name="twitter:description"  content="Background" />
    
  

  <meta property="og:site_name" content="Crisscross Landscapes" />
  <meta property="og:title" content="Analyze Text Similarity with R: Latent Semantic Analysis and Multidimentional Scaling"/>
  
  <meta property="og:description" content="Background" />
  
  <meta property="og:image" content="http://bodong.ch//assets/images/df_logo.png" />
  <meta property="og:url" content="http://bodong.ch//blog/2013/03/11/analyze-text-similarity-in-r-latent-semantic-analysis-and-multidimentional-scaling.html" >
  <meta property="og:type" content="blog" />
  <meta property="article:published_time" content="2013-03-11T00:00:00-05:00">

  <link rel="canonical" href="http://bodong.ch//blog/2013/03/11/analyze-text-similarity-in-r-latent-semantic-analysis-and-multidimentional-scaling.html"/>
  <link rel="shortcut icon" href="/assets/images/favicon.png" type="image/png"/>
  <link rel="stylesheet" href="//brick.a.ssl.fastly.net/Linux+Libertine:400,400i,700,700i/Open+Sans:400,400i,700,700i">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

  <link rel="stylesheet" type="text/css" media="screen" href="/css/main.css" />
  <link rel="stylesheet" type="text/css" media="print" href="/css/print.css" />
  <link rel="stylesheet" type="text/css" media="screen" href="/css/custom.css" />
</head>

  <body itemscope itemtype="http://schema.org/Article">
    <!-- header start -->

<a href="http://bodong.ch/" class="logo-readium"><span class="logo" style="background-image: url(/assets/images/df_logo.png)"></span></a>

<!-- header end -->

    <main class="content" role="main">
      <article class="post">
        
        <div class="noarticleimage">
          <div class="post-meta">
            <h1 class="post-title">Analyze Text Similarity with R: Latent Semantic Analysis and Multidimentional Scaling</h1>
            <div class="cf post-meta-text">
              <div class="author-image" style="background-image: url(/assets/images/author.jpg)">Blog Logo</div>
              <h4 class="author-name" itemprop="author" itemscope itemtype="http://schema.org/Person"></h4>
              on
              <time datetime="2013-03-11T00:00:00-05:00">11 Mar 2013</time>
              
                <a class="tag_list_link" href="/tag/r">r</a>
              
                <a class="tag_list_link" href="/tag/semantic analysis">semantic analysis</a>
              
                <a class="tag_list_link" href="/tag/text mining">text mining</a>
              
                <a class="tag_list_link" href="/tag/knowledge forum">knowledge forum</a>
              
            </div>
          </div>
        </div>
        <br>
        <br>
        <br>
        
        <section class="post-content">
          <div class="post-reading">
            <span class="post-reading-time"></span> read
          </div>
          <a name="topofpage"></a>
          <h2 id="background">Background</h2>

<p>One of the most pressing questions I have been pondering upon when
redesigning <a href="http://www.knowledgeforum.com/">Knowledge Forum</a> is how to
represent the knowledge space of a community to better support idea
improvement. Many people think Knowledge Forum as another discussion
forum (or learning management system) with a 2-D interface (see below).
This notion lead people to treat a Knowledge Forum <em>view</em> merely as a
container of <em>notes</em>. The reason why this happens is because users
usually fail to recognize one important principle behind the design of
Knowledge Forum <em>view</em>: to support <em>multiple perspectives</em> of community
knowledge. According to this principle, a view should not be a container
of notes, but provides a specific perspective that helps people work on
ideas in those notes. Although current Knowledge Forum tries to embody
this principle in its functionalities, such as flexible movements of
notes across views, the representation of knowledge within a view still
rigidly depends on placement of notes by users. As a result, it puts too
much burden on users to achieve the goal of perceiving or discovering
<em>multiple perspectives</em>. Therefore, how could we design techniques to
provide additional perspectives of knowledge presents to be an
interesting challenge.</p>

<p><img src="http://www.knowledgeforum.com/Kforum/Images/Pic2_4_6.jpg" alt="Knowledge Forum view and
notes" /></p>

<p>Embarking on this challenge, I started to think maybe the first
alternative perspective I could work on is semantic relations among
<em>notes</em> in a <em>view</em>. The idea is simple. Given a bunch of notes in a
view, put those semantically similar ones together so users could more
easily discern different semantic territories in this view and work more
productively with ideas. (I am sure I am reinventing the wheel here, so
it will be great if you can point me to any relevant resources.)</p>

<p>In this post, I am demoing a “toy” (made with R) that presents my
initial endeavor to solve this problem. Using <a href="http://en.wikipedia.org/wiki/Latent_semantic_analysis">Latent Semantic Analysis
(LSA)</a> (and <a href="http://cran.r-project.org/web/packages/lsa/index.html">its
R package</a>), I
could analyze relationships between a set of notes based on what words
and latently similar words they share. Then using <a href="http://en.wikipedia.org/wiki/Multidimensional_scaling">mutidimentional
scaling (MDS)</a>, a
statistical technique for exploring similarities I just learned last
week, I could scale and visualize note similarities on a 2- or 3-D
space. The goal, as explained above, is to provide users an alternative
perspective of their knowledge space.</p>

<p>Below I am describing steps of analysis of the prototypic tool.</p>

<h2 id="prepare-mock-data">Prepare mock data</h2>

<p>First, we need some mock data that show some semantic diversity. In this
case, I am making up 9 notes about three topics: food, electricity, and
birds. After a few typical text mining processes, such as stopwords
removal and stemming, we have a corpus ready to work with.</p>

<div class="highlighter-rouge"><pre class="highlight"><code># load required libraries
library(tm)
library(ggplot2)
library(lsa)

# 1. Prepare mock data
text &lt;- c("transporting food by cars will cause global warming. so we should go local.",
    "we should try to convince our parents to stop using cars because it will cause global warming.",
    "some food, such as mongo, requires a warm weather to grow. so they have to be transported to canada.",
    "a typical electronic circuit can be built with a battery, a bulb, and a switch.",
    "electricity flows from batteries to the bulb, just like water flows through a tube.",
    "batteries have chemical energe in it. then electrons flow through a bulb to light it up.",
    "birds can fly because they have feather and they are light.", "why some birds like pigeon can fly while some others like chicken cannot?",
    "feather is important for birds' fly. if feather on a bird's wings is removed, this bird cannot fly.")
view &lt;- factor(rep(c("view 1", "view 2", "view 3"), each = 3))
df &lt;- data.frame(text, view, stringsAsFactors = FALSE)

# prepare corpus
corpus &lt;- Corpus(VectorSource(df$text))
corpus &lt;- tm_map(corpus, tolower)
corpus &lt;- tm_map(corpus, removePunctuation)
corpus &lt;- tm_map(corpus, function(x) removeWords(x, stopwords("english")))
corpus &lt;- tm_map(corpus, stemDocument, language = "english")
corpus  # check corpus

## A corpus with 9 text documents
</code></pre>
</div>

<h2 id="mds-with-raw-term-document-matrix">MDS with raw term-document matrix</h2>

<p>With this corpus, we can compute a term-document matrix that contains
occurrance of terms in each note. As a starting point, we can then
compute distance between pairs of documents and scale the
multidimentional semantic space onto two dimensions. Results of scaling
are plotted on a graph.</p>

<div class="highlighter-rouge"><pre class="highlight"><code># 2. MDS with raw term-document matrix compute distance matrix
td.mat &lt;- as.matrix(TermDocumentMatrix(corpus))
dist.mat &lt;- dist(t(as.matrix(td.mat)))
dist.mat  # check distance matrix

##       1     2     3     4     5     6     7     8
## 2 2.828
## 3 3.000 3.873
## 4 3.742 4.000 3.873
## 5 4.000 4.243 4.123 3.464
## 6 3.742 4.000 3.873 2.828 2.828
## 7 3.317 3.606 3.464 3.317 3.606 3.000
## 8 3.317 3.606 3.464 3.317 3.606 3.317 2.000
## 9 5.099 5.292 5.196 5.099 5.292 5.099 3.000 3.606


# MDS
fit &lt;- cmdscale(dist.mat, eig = TRUE, k = 2)
points &lt;- data.frame(x = fit$points[, 1], y = fit$points[, 2])
ggplot(points, aes(x = x, y = y)) + geom_point(data = points, aes(x = x, y = y,
    color = df$view)) + geom_text(data = points, aes(x = x, y = y - 0.2, label = row.names(df)))
</code></pre>
</div>

<p><img src="https://dl.dropbox.com/u/7599158/wp/figure/mds-row.png" alt="plot of chunk
mds-row" /></p>

<p>The results are acceptable, given those notes under the same topic seem
to be close to each other. Three clusters of notes mapping with three
topics emerged, although note 9 is a bit far off on the x dimension.</p>

<h2 id="mds-with-lsa">MDS with LSA</h2>

<p>With LSA, we can go one step further by taking latent similarity between
notes into consideration. This technique is expected to be much superior
to using raw term-document matrix because, as you see in the code, it
does additional weighting and is able to find latent links.</p>

<div class="highlighter-rouge"><pre class="highlight"><code># 3. MDS with LSA
td.mat.lsa &lt;- lw_bintf(td.mat) * gw_idf(td.mat)  # weighting
lsaSpace &lt;- lsa(td.mat.lsa)  # create LSA space
dist.mat.lsa &lt;- dist(t(as.textmatrix(lsaSpace)))  # compute distance matrix
dist.mat.lsa  # check distance mantrix

##         1       2       3       4       5       6       7       8
## 2  6.9720
## 3  8.2482 14.9605
## 4  9.6561 13.0836 12.8002
## 5  8.0963 11.9788 11.6686  2.4150
## 6  9.0802 12.6645 12.3715  2.4007  1.7214
## 7  7.6546 11.6848 11.3666  8.7133  6.3557  6.7759
## 8  7.5055 11.5876 11.2667  9.0778  6.6877  7.2384  0.6671
## 9  9.0005 12.6075 12.3132 10.5855  8.3089  8.4643  2.1678  2.2945


# MDS
fit &lt;- cmdscale(dist.mat.lsa, eig = TRUE, k = 2)
points &lt;- data.frame(x = fit$points[, 1], y = fit$points[, 2])
ggplot(points, aes(x = x, y = y)) + geom_point(data = points, aes(x = x, y = y,
    color = df$view)) + geom_text(data = points, aes(x = x, y = y - 0.2, label = row.names(df)))
</code></pre>
</div>

<p><img src="https://dl.dropbox.com/u/7599158/wp/figure/mds-lsa.png" alt="plot of chunk
mds-lsa" /></p>

<p>The results are quite different from what we got with the raw
term-document matrix. While notes under view 2 and 3 become more tightly
clustered together, three notes under view 1 get stretched on the y
coordinate. Comparing the distance matrix based on LSA with the one
based on raw term-document matrix, I realized the distance among note
1-3 got significantly increased after LSA. I am not sure how exactly
this has happened, and this issue could get even more complicated when
we have dozens of notes to analyze.</p>

<p>Will it be better if we could plot scaling results in 3D?</p>

<div class="highlighter-rouge"><pre class="highlight"><code>library(scatterplot3d)
fit &lt;- cmdscale(dist.mat.lsa, eig = TRUE, k = 3)
colors &lt;- rep(c("blue", "green", "red"), each = 3)
scatterplot3d(fit$points[, 1], fit$points[, 2], fit$points[, 3], color = colors,
    pch = 16, main = "Semantic Space Scaled to 3D", xlab = "x", ylab = "y",
    zlab = "z", type = "h")
</code></pre>
</div>

<p><img src="https://dl.dropbox.com/u/7599158/wp/figure/rds-3d.png" alt="plot of chunk
rds-3d" /></p>

<p>Not really, the first three notes still show some great variance on the
y axis.</p>

<h2 id="extending-to-twitter-analysis">Extending to Twitter analysis</h2>

<p>Building on <a href="http://bodongchen.com/blog/?p=290">my post</a> about Twitter
hashtag analytics, we can test this technique with tweets aggregated by
a same hashtag.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>setwd("~/src/r/twitter-analytics/twitter-hashtag-analytics")
source("utilities.R")
source("get_tweets.R")
source("munge_tweets.R")
source("semantic_analysis.R")

# get tweets from #LAK13
lak13 &lt;- GetTweetsBySearch('#LAK13', 500)
lak13 &lt;- PreprocessTweets(lak13)
corpus &lt;- ConstructCorpus(lak13$text, removeTags=TRUE, removeUsers=TRUE, stemming=TRUE)

# compute distance matrix
td.mat &lt;- as.matrix(TermDocumentMatrix(corpus))
td.mat.lsa &lt;- lw_bintf(td.mat) * gw_idf(td.mat) # weighting
lsaSpace &lt;- lsa(td.mat.lsa) # create LSA space
dist.mat.lsa &lt;- dist(t(as.textmatrix(lsaSpace))) # compute distance matrix

# MDS
fit &lt;- cmdscale(dist.mat.lsa, eig=TRUE, k=2)
points &lt;- data.frame(x=fit$points[, 1], y=fit$points[, 2])
qplot(x, y, data = points, geom = "point", alpha = I(1/5))
</code></pre>
</div>

<p><img src="https://dl.dropbox.com/u/7599158/wp/figure/rds-twitter.png" alt="plot of chunk
rds-twitter" /></p>

<p>This search retrieves 98 tweets. A few clusters emerged, showing heated
discussion seemingly around the topic in the middle. Because <code class="highlighter-rouge">ggplot2</code>
does not support interactivity on the plot, it is hard to tell what
those topics are about. But it will be easy to export the results into a
<code class="highlighter-rouge">JSON</code> object that can be consumed by tools like <a href="http://d3js.org/">D3</a>
to produce powerful visualizations with interaction capability.</p>

<p>All source code used in this post can be found in a
<a href="https://gist.github.com/dirkchen/5135687">gist</a>.</p>

        </section>
        <footer class="post-footer">
          <section class="share">
            
              
                <a class="icon-twitter" href="http://twitter.com/share?text=Analyze+Text+Similarity+with+R%3A+Latent+Semantic+Analysis+and+Multidimentional+Scaling&amp;url=http://bodong.ch//blog/2013/03/11/analyze-text-similarity-in-r-latent-semantic-analysis-and-multidimentional-scaling"
                  onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;">
                <i class="fa fa-twitter"></i><span class="hidden">twitter</span>
                </a>
              
            
              
            
          </section>
        </footer>
        <div class="bottom-teaser cf">
          <div class="isLeft">
            <h5 class="index-headline featured"><span>Written by</span></h5>
            <section class="author">
              <div class="author-image" style="background-image: url(/assets/images/author.jpg)">Blog Logo</div>
              <h4>Bodong Chen</h4>
              <p class="bio"></p>
              <hr>
              <p class="published">Published <time datetime="2013-03-11 00:00">11 Mar 2013</time></p>
            </section>
          </div>
          <div class="isRight">
            <h5 class="index-headline featured"><span>Supported by</span></h5>
            <footer class="site-footer">
              <section class="poweredby">Proudly published with <a href="http://jekyllrb.com"> Jekyll</a></section>
              <a class="subscribe" href="/feed.xml"> <span class="tooltip"> <i class="fa fa-rss"></i> You should subscribe to my feed.</span></a>
              <div class="inner">
                <section class="copyright">All content copyright <a href="http://bodong.ch//">Bodong Chen</a> &copy; 2018<br>All rights reserved.</section>
              </div>
            </footer>
          </div>
        </div>
        
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'meefen'; // required: replace example with your forum shortname

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        
      </article>
    </main>
    <div class="bottom-closer">
      <div class="background-closer-image"  style="background-image: url(/assets/images/delicate-arch-night-stars-landscape.jpg)">
        Image
      </div>
      <div class="inner">
        <h1 class="blog-title">Crisscross Landscapes</h1>
        <h2 class="blog-description">Bodong Chen, University of Minnesota
</h2>
        <a href="/" class="btn">Back to Home</a>
      </div>
    </div>
    <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
<script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/assets/js/index.js"></script>
<script type="text/javascript" src="/assets/js/readingTime.min.js"></script>
<script>
(function ($) {
  "use strict";
  $(document).ready(function(){

    var $window = $(window),
    $image = $('.post-image-image, .teaserimage-image');

      $window.on('scroll', function() {
        var top = $window.scrollTop();

        if (top < 0 || top > 1500) { return; }
        $image
          .css('transform', 'translate3d(0px, '+top/3+'px, 0px)')
          .css('opacity', 1-Math.max(top/700, 0));
      });
      $window.trigger('scroll');

      var height = $('.article-image').height();
      $('.post-content').css('padding-top', height + 'px');

      $('a[href*=#]:not([href=#])').click(function() {
        if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'')
         && location.hostname == this.hostname) {
          var target = $(this.hash);
          target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
          if (target.length) {
            $('html,body').animate({ scrollTop: target.offset().top }, 500);
            return false;
          }
        }
      });

  });
}(jQuery));
</script>

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-50108133-1', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>
